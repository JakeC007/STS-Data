---
title: "Viz Creation"
author: "Jake Chanenson"
date: "4/18/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(foreign)      
library(ggplot2)      
library(colorspace)   #better colors for ggplot
library(tidyverse)    
library(dplyr)
library(gridExtra)
library(viridis)
library(ggridges)
library(socviz)
library(broom)
library(stargazer)
library(corrr)
library(GGally)
library(haven) #needed to import stada data
library(RColorBrewer)
library(grid)
library(likert) # for creating a likert plot
```

```{r load-data}
load("../../Pew/pewTech.RData")
```

## `Know` Dummy Var
Generate counts and props of how many people get the following questions right 

* KNOW9

* KNOW8

* KNOW7

* KNOW4 

* KNOW3

* KNOW1

```{r}
## Generate count dummies
count_df <- pew %>% mutate(K1T = ifelse(KNOW1_W49 == "Can track your visits and activity on the site", yes = 1, no = 0 ),
               K3T = ifelse(KNOW3_W49 == "Has created a contract between itself and its users about how it will use their data", yes = 1, no = 0),
               K4T = ifelse(KNOW4_W49 == "Information entered into the site is encrypted", yes = 1, no = 0),
               K7T = ifelse(KNOW7_W49 == "Internet service providers should treat all traffic on their networks equally", yes = 1, no = 0),
               K8T = ifelse(KNOW8_W49 == "A coworker who uses the same computer", yes = 1, no = 0),
               K9T = ifelse(KNOW9_W49 == "Picture of 2-step code", yes = 1, no = 0)
               ) %>% select(K1T, K3T, K4T, K7T, K8T, K9T)
count_df

## Sum count dummies, add to pew data set
pew <- pew %>% mutate(sumKnow134789 = count_df$K1T+count_df$K3T+count_df$K4T+count_df$K7T+count_df$K8T+count_df$K9T,
               propKnow134789 = sumKnow134789/6,
               .after = TOTALKNOW_W49)
```


```{r}
pew %>% ggplot(aes(x = sumKnow134789)) +
  geom_bar()
```


```{r}
dum <- as_factor(pew$sumKnow134789)
pew <- pew %>% mutate(sumKnowFactor = dum, .after = sumKnow134789)

foo1 <- levels(pew$sumKnowFactor) #why can't this be a quant var 

pew %>% drop_na(DATAUSEd_W49) %>% ggplot(aes(x = DATAUSEd_W49, fill = sumKnowFactor)) +
  geom_bar(position = "dodge") +
  scale_fill_brewer(palette = "Dark2", limits = rev(foo1))
```


```{r}
pew %>% drop_na(DATAUSEd_W49) %>% ggplot(aes(x = DATAUSEd_W49, y = propKnow134789)) +
  geom_boxplot(outlier.colour="red", outlier.shape=16,
             outlier.size=2, notch=FALSE) +
  geom_jitter(shape=1, position=position_jitter(0.2)) +
  scale_y_continuous(label = scales::percent) +
  labs (
    title = "Tech Literacy VS Opinions on Data Sharing For Research",
    # subtitle = "Optional",
    x = "How Respondents Feel About Sharing Fitness Tracking Data\nWith Medical Researchers",
    y = "Tech Literacy",
    caption = "Series 2 Picture 1"
  )
```



```{r, echo = echoVal, warning= F, message = F}

pew <- pew %>% mutate(HOMEASSIST1_num = ifelse(HOMEASSIST1_W49 == "Yes", yes = 1, 
                                         ifelse(HOMEASSIST1_W49 == "No", yes = 0, no  = NA)))
pew %>% drop_na(DATAUSEd_num) %>%  
  ggplot(aes(x= propKnow134789, y=DATAUSEd_num)) +
  geom_jitter(aes(color = DATAUSEd_num), alpha=.3, size =1, height = .1, width = .005)+
  geom_smooth(method = "glm",
    method.args = list(family = "binomial"), se = T, color ='black') +
  # scale_color_manual(values = c('blue','red'))+
  theme_bw()
```

```{r}

pew <- pew %>% mutate(DATAUSEd_num = ifelse(DATAUSEd_W49 == "Acceptable", yes = 1, 
                                         ifelse(DATAUSEd_W49 == "Unacceptable", yes = 0, 
                                                ifelse(DATAUSEd_W49 == "Not sure", yes = -1, no  = NA))),
                      DATAUSEd_fct = as_factor(DATAUSEd_W49))
pew %>% drop_na(DATAUSEd_num) %>% filter(DATAUSEd_num != -1) %>%  
  ggplot(aes(x= propKnow134789, y=DATAUSEd_num)) +
  geom_jitter(aes(color = DATAUSEd_fct), alpha=.3, size =1, height = .1, width = .005)+
  geom_smooth(method = "glm",
    method.args = list(family = "binomial"), se = T, color ='black') +
  # scale_color_manual(values = c('blue','red'))+
  theme_bw()

```

```{r}

pew %>% ggplot(aes(x = ,  y = DATAUSEd_W49 )) + 
  geom_tile(aes(fill= propKnow134789)) + scale_fill_gradient(low="green", high="red")
  # geom_text(data = pew %>% select(propKnow134789), stat='count', aes(label=..count..)) 

#perhaps a confusion matrix is what you want https://stackoverflow.com/questions/56589854/geom-tile-fill-in-confusion-matrix-correspond-to-value
```


ella says:
```{r eval = F}
trumpCollege_proportionsByEducation <- countyData %>%
  drop_na(majorityTrump) %>%
  group_by(college_2cat) %>%
  count(majorityTrump, college_2cat) %>%
  mutate(percent_by_collegeCategory = 100*prop.table(n))  %>%
  rename(number_counties_by_collegeCategory = n) (edited) 
```


## Question 1: My 6(ish) Images

```{r}
pew %>% drop_na(DATAUSEd_W49) %>% ggplot(aes(x = DATAUSEd_W49, y = propKnow134789)) +
  geom_boxplot(outlier.colour="red", outlier.shape=16,
             outlier.size=2, notch=FALSE) +
  geom_jitter(shape=1, position=position_jitter(0.2)) +
  scale_y_continuous(label = scales::percent) +
  labs (
    title = "Tech Literacy VS Opinions on Data Sharing For Research",
    # subtitle = "Optional",
    x = "How Respondents Feel About Sharing Fitness Tracking Data\nWith Medical Researchers",
    y = "Tech Literacy",
    caption = "Series 2 Picture 1"
  )
```
           
           
```{r}

dum <- as_factor(pew$sumKnow134789)
pew <- pew %>% mutate(sumKnowFactor = dum, .after = sumKnow134789)

foo1 <- levels(pew$sumKnowFactor) #why can't this be a quant var 

pew %>% drop_na(HOMEASSIST2_W49) %>% ggplot(aes(y = HOMEASSIST2_W49, x = propKnow134789)) +
  geom_boxplot(outlier.colour="red", outlier.shape=16,
             outlier.size=2, notch=FALSE) +
  scale_x_continuous(label = scales::percent) +
  labs (
    title = "Tech Literacy VS Smart Speaker Data Collection Concerns",
    # subtitle = "Optional",
    y = "How Concerned Respondents Are About\nHow Much Data Your Smart Speaker
Collects",
    x = "Tech Literacy",
    caption = "Series 2 Picture 2"
  )
```

           
```{r}
# PP2
bar1 <- c("0" = "No Literacy ", "1" = "17% Literate", "2" = "33% Literate", "3" = "50% Literate", "4" = "67% Literate", "5" = "83% Literate", "6" = "Fully Literate" )

pew %>% drop_na(PP2_W49) %>% filter(PP2_W49 != "Refused") %>%  ggplot(aes(x = PP2_W49, fill = PP2_W49)) +
  geom_bar() +
  facet_wrap(sumKnowFactor ~ ., scales = "free_y", labeller = labeller(sumKnowFactor = bar1 )) +
  theme(
    axis.title.x = element_blank(),
    axis.text.x = element_blank()) +
  labs (
    title = "Tech Literacy VS Privacy Policy Reading Habits",
    # subtitle = "Optional",
    fill = "Privacy Policy Reading Habbits",
    x = "Tech Literacy Level",
    caption = "Series 2 Picture 3"
  )
```
    
    
```{r}
# PP2

pew <- pew %>% mutate(groupKnow = ifelse(sumKnowFactor == 0, yes = "No Literacy",
                           ifelse(sumKnowFactor == 1| sumKnowFactor == 2| sumKnowFactor == 3| sumKnowFactor == 4, yes = "Some Literacy", no = "High Literacy")),
               groupKnow = as_factor(groupKnow))

#graph 
pew %>% drop_na(PP2_W49) %>% filter(PP2_W49 != "Refused") %>% ggplot(aes(x = PP2_W49, fill = PP2_W49)) +
  geom_bar() +
  facet_wrap(. ~groupKnow, scales = "free_y") +
  theme(
    axis.title.x = element_blank(),
    axis.text.x = element_blank()) +
  labs (
    title = "Privacy Policy Reading Habits Faceted on Tech Literacy",
    # subtitle = "Optional",
    fill = "Privacy Policy\nReading Habbits",
    x = "Tech Literacy Level",
    caption = "Series 2 Picture 4\nNo Literacy = 0/6\nSome Literacy = [1/6, 4/6]\nHigh Literacy = [5\6, 6/6]"
  )
```

### Lets Look At Some Regressions

CONCERNGOV How concerned are you, if at all, about how the government is using the data
it collects about you?
```{r}

pew <- pew %>% mutate(CONCERNGOV_num = ifelse(CONCERNGOV_W49 == "Very concerned" |CONCERNGOV_W49 == "Somewhat concerned" , yes = 1, 
                                         ifelse(CONCERNGOV_W49 == "Not too concerned" | CONCERNGOV_W49 == "Not at all concerned", yes = 0, no = NA)),
                      CONCERNGOV_num_fct = factor(CONCERNGOV_num)
                      )

levels(pew$CONCERNGOV_num_fct) <- c("No", "Yes")

pew %>% drop_na(CONCERNGOV_num) %>% filter(CONCERNGOV_num != -1) %>%  
  ggplot(aes(x= propKnow134789, y=CONCERNGOV_num)) +
  geom_jitter(aes(color = CONCERNGOV_num_fct ), alpha=.3, size =1, height = .1, width = .005)+
  geom_smooth(method = "glm",
    method.args = list(family = "binomial"), se = T, color ='black') +
  scale_color_manual(values = c('blue','red'))+
  scale_x_continuous(label = scales::percent) +
  labs (
    title = "Concern About Government Data Usage VS Tech Literacy",
    color = "Are Respondants Concerned About\nGovernment Data Usage",
    x = "Tech Literacy Level",
    y = "",
    caption = "Series 2 Picture 5"
  )
```
GOVREGV2 Compared with five years ago, do you feel your personal information is…

```{r}

levels(pew$GOVREGV2_W49)
pew <- pew %>% mutate(GOVREGV2_num = ifelse(GOVREGV2_W49 == "Better tools for allowing people to control their personal information themselves" , yes = 1, 
                                         ifelse(GOVREGV2_W49 == "Stronger laws governing what companies can and cannot do with people’s personal information", yes = 0, no = NA)),
                      GOVREGV2_num_fct = factor(GOVREGV2_num)
                      )

levels(pew$GOVREGV2_num_fct) <- c("Stronger Data Protection Laws", "Better Tools To Control Data")

pew %>% drop_na(GOVREGV2_num) %>%  
  ggplot(aes(x= propKnow134789, y=GOVREGV2_num)) +
  geom_jitter(aes(color = GOVREGV2_num_fct ), alpha=.3, size =1, height = .1, width = .005)+
  geom_smooth(method = "glm",
    method.args = list(family = "binomial"), se = T, color ='black') +
  scale_color_manual(values = c('blue','red'))+
  scale_x_continuous(label = scales::percent) +
  labs (
    title = "Opinion on Best Method To Protect Data\nVS Tech Literacy",
    color = "What is a more effective way to\nsafeguard people’s personal information",
    x = "Tech Literacy Level",
    y = "",
    caption = "Series 2 Picture 6"
  )

```


```{r}
# PP2
bar1 <- c("0" = "No Literacy ", "1" = "17% Literate", "2" = "33% Literate", "3" = "50% Literate", "4" = "67% Literate", "5" = "83% Literate", "6" = "Fully Literate" )

pew %>% drop_na(CONTROLCO_W49) %>% filter(CONTROLCO_W49 != "Refused") %>%  ggplot(aes(x = CONTROLCO_W49, fill = CONTROLCO_W49)) +
  geom_bar() +
  facet_wrap(sumKnowFactor ~ ., scales = "free_y", labeller = labeller(sumKnowFactor = bar1 )) +
  theme(
    axis.title.x = element_blank(),
    axis.text.x = element_blank()) +
  labs (
    title = "Tech Literacy VS Privacy Policy Reading Habits",
    # subtitle = "Optional",
    fill = "Privacy Policy Reading Habbits",
    x = "Tech Literacy Level",
    caption = "Series 2 Picture 8"
  )
```

## Question 2

Series 2 pictures 1 and 2 are my experiment with box plots. In both plots I used the Tech literacy variable to compare against two different multi-answer questions (Data sharing for research vs concerns over smart speaker data collection). Before selecting these as graphs to submit, I tried to display this data in other forms. I felt that the box plot was a good way to get this data across since I was plotting one quantitative variable and one categorical variable. Between the two of them, I think picture 2 is the better image. This is because it does not have the `geom_jitter` overlay. I like the geom jitter overlay and if the y axis on picture one has values that spread across the range of all possible values, I think it would add something to the graph. However, this is not the case and plotting the points on the bar chart only displays several discretized bands. I do not think this adds anything to the plot except visual clutter. Thus, the more stripped-down plot is the way to go. On the orientation of the two plots, I like the second image better where the categorical labels are on the y-axis. I feel like its easier to read the labels and compare the Q1, Q3 and median lines.     


Series 2 pictures 3 and 4 keep the data the same but change the binning. As you can see, they are both facet bar charts, but picture 4 has less facets than picture 3. If these were stacked density plots, I think I might have been more interested in image 3 because I could see how each literacy level’s opinion shifted. However, given that I chose to do facet bar charts, I like picture four more. I think there is not enough obvious variation over the six levels to warrant all that information on display. Picture four simplifies the story a little bit and makes it easier to see how each larger group changes. One thing I was unsure about was how I grouped the levels of literacy. As you can see in the caption of 0picture four, I elected to make “No Literacy” its own group those who scored 1/6 to 4/6 the “middling” own group and those who got 5/6 or 6/6 the “High Literacy” group. I felt it was important to partition out those with no knowledge. However, I wonder if the unbalanced way I grouped the data may lead to negative consequences. Would it have been smarter to do lower third, middle third and upper third? 


Series 2 pictures 5 and 6 are my attempt at looking for patterns via regression. I think picture six is the more interesting picture even though the correlation is quite weak. This is because it shows that ones level of tech literacy does not majorly affect what they think the right solution is to protect one’s data. If I am reading the graph right, it seems that those who are more literate want better tools but that may just be because they feel comfortable using said tools. The regression shown on graph 5 has a stronger and more exciting correlation. Unfortunately, to make the graph I condensed 4 categories into a binary yes/no which makes me a little leery of the results. 



# HW 10


```{r}
# PP2

pew <- pew %>% mutate(groupKnow = ifelse(sumKnowFactor == 0, yes = "No Literacy",
                           ifelse(sumKnowFactor == 1| sumKnowFactor == 2| sumKnowFactor == 3| sumKnowFactor == 4, yes = "Some Literacy", no = "High Literacy")),
               groupKnow = as_factor(groupKnow))

#graph 
pew %>% drop_na(PP2_W49) %>% filter(PP2_W49 != "Refused") %>% ggplot(aes(x = PP2_W49, fill = PP2_W49)) +
  geom_bar(color = 'black') +
  facet_wrap(. ~groupKnow, scales = "free_y") +
  theme(
    axis.title.x = element_blank(),
    axis.text.x = element_blank()) +
  labs (
    title = "Privacy Policy Reading Habits Faceted on Tech Literacy",
    # subtitle = "Optional",
    fill = "Privacy Policy\nReading Habbits",
    x = "Tech Literacy Level",
    caption = "Series 2 Picture 4\nNo Literacy = 0/6\nSome Literacy = [1/6, 4/6]\nHigh Literacy = [5/6, 6/6]"
  )
```

```{r}
levels(pew$SHARE1_W49)
pew %>% drop_na(SHARE1_W49) %>% filter(SHARE1_W49 != "Refused") %>% ggplot(aes(x = SHARE1_W49, fill = SHARE1_W49)) +
  geom_bar(color = 'black') +
  facet_wrap(. ~groupKnow, scales = "free_y") +
  theme(
    axis.title.x = element_blank(),
    axis.text.x = element_blank()) +
  labs (
    title = "Online Data Sharing Habits Faceted on Tech Literacy",
    # subtitle = "Optional",
    fill = "Decided Not To Use A Service\nOver How Much Personal Info Collected",
    x = "Tech Literacy Level",
    caption = "Series 2 Picture 4\nNo Literacy = 0/6\nSome Literacy = [1/6, 4/6]\nHigh Literacy = [5/6, 6/6]"
  )
```

```{r}
pew %>% drop_na(CONCERNCO_W49) %>% filter(CONCERNCO_W49 != "Refused") %>% ggplot(aes(x = CONCERNCO_W49, fill = CONCERNCO_W49)) +
  geom_bar(color = 'black') +
  facet_wrap(. ~groupKnow, scales = "free_y") +
  theme(
    axis.title.x = element_blank(),
    axis.text.x = element_blank()) +
  labs (
    title = "Concern Of Company Tracking Faceted on Tech Literacy",
    # subtitle = "Optional",
    fill = "How Concerned Are You\nAbout Companies Tracking You?",
    x = "Tech Literacy Level",
    caption = "Series 2 Picture 4\nNo Literacy = 0/6\nSome Literacy = [1/6, 4/6]\nHigh Literacy = [5/6, 6/6]"
  )
ggsave(file = "../imgs/CONCERNCO.png")
```
This is interesting because the concern drops as people gain a higer litercay


```{r}
levels(pew$PROFILE4_W49)
pew %>% drop_na(PROFILE4_W49) %>% filter(PROFILE4_W49 != "Refused") %>% ggplot(aes(x = PROFILE4_W49, fill = PROFILE4_W49)) +
  geom_bar(color = 'black') +
  facet_wrap(. ~groupKnow, scales = "free_y") +
  theme(
    axis.title.x = element_blank(),
    axis.text.x = element_blank()) +
  labs (
    title = "Understanding of Targeted Ad Data Faceted on Tech Literacy",
    # subtitle = "Optional",
    fill = "Do You Understand What Data\nIs Used To Create Targeted Ads?",
    x = "Tech Literacy Level",
    caption = "Series 2 Picture 4\nNo Literacy = 0/6\nSome Literacy = [1/6, 4/6]\nHigh Literacy = [5/6, 6/6]"
  )
ggsave(file = "../imgs/PROFILE4.png")
```
The interesting takeaway here is that regardless of tech litercay people don't understand what data is used to target them. This is interesting because I HAVE ANOTHER CORRELATION TO SHOW THAT LITERACY AND TECH WORRY are hand in hand 


```{r FACE3 Data}
## Create df of FACE3
df_f3 <- pew %>% filter(FACE3a_W49 != "No Answer" & FACE3b_W49 != "No Answer" & FACE3c_W49 != "No Answer") %>% filter(FACE3a_W49 != "Refused" & FACE3b_W49 != "Refused" & FACE3c_W49 != "Refused") %>%  select(c(FACE3a_W49, FACE3b_W49, FACE3c_W49, groupKnow))

## Rename Cols
df_f3  <- df_f3  %>% 
  rename("Advertisers' Use Of Facial Recognition" = FACE3a_W49,
          "Tech Companies' Use Of Facial Recognition" = FACE3b_W49,
          "Law Enforcement's Use Of Facial Recognition" = FACE3c_W49)
df_f3  <- as.data.frame(df_f3)
df_f3 <- droplevels(df_f3) #remove unused levels 
df_f3 <- df_f3[, c(3,2,1,4)] #change order of cols for facets to come in nice order

## Reverse levels 
df_f3.reverse <- reverse.levels(df_f3)
head(df_f3)
head(df_f3.reverse)
                            
## Generate Title
title2 <- "Trust In Responsible Use Of Facial Recognition Tech\nFaceted on Tech Literacy"
```


```{r FACE3 Viz}

## Center with percents
plot(likert(df_f3.reverse[,c(1:3)], grouping = df_f3.reverse[,4]), legend.position="right", centered = TRUE, plot.percents=FALSE, plot.percent.low=TRUE, plot.percent.high=TRUE, plot.percent.neutral=FALSE, center = 2.5, text.color = 'purple') + 
  scale_fill_manual(values = brewer.pal(n=4,"RdBu"), breaks = c("Not at all", "Not too much", "Somewhat", "A great deal")) + #order and color the likert boxes
  ggtitle(title2) +
  guides(fill = guide_legend(title="Responses", reverse = TRUE)) #to reverse the order in the legend
ggsave(file = "../imgs/FACE3_center_percents.png")

## Center No Percents 
plot(likert(df_f3.reverse[,c(1:3)], grouping = df_f3.reverse[,4]), legend.position="right", centered = TRUE, plot.percents=TRUE, plot.percent.low=FALSE, plot.percent.high=FALSE, plot.percent.neutral=FALSE, center = 2.5) + 
  scale_fill_manual(values = brewer.pal(n=4,"RdBu"), breaks = c("Not at all", "Not too much", "Somewhat", "A great deal")) + #order and color the likert boxes
  ggtitle(title2) +
  guides(fill = guide_legend(title="Responses", reverse = TRUE)) #to reverse the order in the legend
ggsave(file = "../imgs/FACE3_center.png")

## Center No Percents 
#to get this to display right the data has to be df_f3 not df_f3.reverse. We keep grouping reverse from no->high litercay
plot(likert(df_f3[,c(1:3)], grouping = df_f3.reverse[,4]), legend.position="right", centered = FALSE, plot.percents=FALSE, plot.percent.low=FALSE, plot.percent.high=FALSE, plot.percent.neutral=FALSE, center = 2.5) + 
  scale_fill_manual(values = brewer.pal(n=4,"RdBu"), breaks = c("Not at all", "Not too much", "Somewhat", "A great deal")) + #order and color the likert boxes
  ggtitle(title2) +
  guides(fill = guide_legend(title="Responses", reverse = TRUE)) #to reverse the order in the legend
ggsave(file = "../imgs/FACE3.png")


```




```{r}
## Create df of FACE3
df_f4 <- pew %>%  select(c(FACE4a_W49, FACE4b_W49, FACE4c_W49, FACE4d_W49, groupKnow))

# df <- data_frame("qa" = pew$FACE4a_W49, "qb" = pew$FACE4b_W49, "qc" = pew$FACE4c_W49, "qd" = pew$FACE4d_W49)
df_f4 <- df_f4 %>% 
  rename("Law Enforcement Assesing Threats In Public Spaces" = FACE4a_W49,
          "Companies Tracking Employee Attendance" = FACE4b_W49,
          "Advertisers Measuring Responses To Public Displays" = FACE4c_W49,
          "Lanlords Tracking Who Enters and Leaves Their Building" = FACE4d_W49)
df_f4 <- as.data.frame(df_f4)
df_f4 <- droplevels(df_f4, exclude = c("Refused", "NA", "<NA>")) #remove unused levels
df_f4 <- droplevels(df_f4)

## Reverse levels 
df_f4.reverse <- reverse.levels(df_f4)
df_f4.reverse2 <- reverse.levels(df_f4.reverse)

df_f4.binary <- droplevels(df_f4.reverse2, exclude = c("Not sure"))

df_f4.binary <- drop_na(df_f4.binary) %>% filter(`Law Enforcement Assesing Threats In Public Spaces` != "NA")

df_f4$`Law Enforcement Assesing Threats In Public Spaces` <- fct_relevel(df_f4$`Law Enforcement Assesing Threats In Public Spaces`, "Acceptable", "Unacceptable", "Not sure")

title1 <- "Opinions on Facial Recognition Use Faceted on Tech Litercay"

```

```{r}
plot(likert(df_f4.reverse[,c(1:4)], grouping = df_f4.reverse[,5]), legend.position="right", plot.percents=FALSE, plot.percent.low=FALSE, plot.percent.high=FALSE, plot.percent.neutral=FALSE, center = 2.5) +
  scale_fill_manual(values = brewer.pal(n=4,"RdBu"), breaks = c("NA", "Not sure", "Unacceptable", "Acceptable")) + #order and color the likert boxes
  # scale_fill_manual(values = brewer.pal(n=4,"RdBu")) +
  ggtitle(title1) +
  guides(fill = guide_legend(title="Responses", reverse = TRUE)) #to reverse the order in the legend
ggsave(file = "../imgs/FACE4.png")

##
plot(likert(df_f4.reverse2[,c(1:4)], grouping = df_f4.reverse[,5]), legend.position="right", centered = FALSE, plot.percents=FALSE, plot.percent.low=FALSE, plot.percent.high=FALSE, plot.percent.neutral=FALSE,) +
  scale_fill_manual(values = brewer.pal(n=4,"RdBu"), breaks = c("NA", "Not sure", "Unacceptable", "Acceptable")) + #order and color the likert boxes
  # scale_fill_manual(values = brewer.pal(n=4,"RdBu")) +
  ggtitle(title1) +
  guides(fill = guide_legend(title="Responses", reverse = TRUE)) #to reverse the order in the legend

##
plot(likert(df_f4.binary[,c(1:4)], grouping = df_f4.binary[,5]), legend.position="right", centered = FALSE, plot.percents=FALSE, plot.percent.low=FALSE, plot.percent.high=FALSE, plot.percent.neutral=FALSE,) +
  # scale_fill_manual(values = brewer.pal(n=4,"RdBu"), breaks = c("NA", "Not sure", "Unacceptable", "Acceptable")) + #order and color the likert boxes
  scale_fill_manual(values = brewer.pal(n=2,"RdBu")) +
  ggtitle(title1) +
  guides(fill = guide_legend(title="Responses", reverse = TRUE)) #to reverse the order in the legend
```





```{r}
items <- c("Law Enforcement Assesing Threats In Public Spaces",
          "Companies Tracking Employee Attendance",
          "Advertisers Measuring Responses To Public Displays",
          "Lanlords Tracking Who Enters and Leaves Their Building")
acceptabe <- c(68, 35, 18, 42)
unacceptable <- c(17, 47, 63, 39)
NS <- c(15, 18, 18, 18)

fab_df <- data_frame(items, acceptabe, unacceptable, NS )
fab_df <- fab_df %>% rename("Item" = items, "Not sure" = NS)
fab_df <- as.data.frame(fab_df)
plot(likert(summary = fab_df, pew$groupKnow)) + ggtitle(title1)
```

              